<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Programme IESS - Kairouan</title>
<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', Arial, sans-serif;
    background: linear-gradient(-45deg, #4CAF50, #66BB6A, #81C784, #A5D6A7);
    background-size: 400% 400%;
    animation: gradientShift 10s ease infinite;
    overflow: hidden;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: background 3s ease;
  }
  @keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  /* INTRO LOGO */
  .intro-logo {
    position: fixed;
    top: 50%;
    left: 50%;
    width: 320px;
    height: auto;
    transform: translate(-50%, -50%) scale(0.5);
    opacity: 0;
    z-index: 9999;
    animation: introShow 5s ease-in-out forwards;
    filter: drop-shadow(0 0 25px rgba(0,255,128,0.8));
  }
  @keyframes introShow {
    0% { opacity: 0; transform: translate(-50%, -50%) scale(0.3) rotateY(0deg); }
    30% { opacity: 1; transform: translate(-50%, -50%) scale(1.1) rotateY(180deg); }
    60% { opacity: 1; transform: translate(-50%, -50%) scale(1) rotateY(360deg); }
    100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8) rotateY(720deg); }
  }

  /* Logo UTSS en fond */
  .background-logo {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 550px;
    height: auto;
    opacity: 0;
    transform: translate(-50%, -50%) scale(1.3);
    z-index: 0;
    filter: drop-shadow(0 0 25px rgba(255,255,255,0.4));
    animation: bgAppear 8s ease-in-out forwards;
    transition: all 2s ease-in-out;
  }
  @keyframes bgAppear {
    0% { opacity: 0; transform: translate(-50%, -50%) scale(1.5); }
    50% { opacity: 0.5; transform: translate(-50%, -50%) scale(1.1); }
    100% { opacity: 0.25; transform: translate(-50%, -50%) scale(1.2); }
  }
  body.idle-mode .background-logo {
    opacity: 0.4;
    animation: pulseBG 6s ease-in-out infinite;
    filter: drop-shadow(0 0 40px rgba(0,255,100,0.6));
  }
  @keyframes pulseBG {
    0%,100% { transform: translate(-50%, -50%) scale(1.2); }
    50% { transform: translate(-50%, -50%) scale(1.28); }
  }

  .container {
    position: relative;
    text-align: center;
    background: rgba(0,0,0,0.45);
    padding: 60px 70px;
    border-radius: 20px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.4);
    color: white;
    animation: fadeIn 2s ease-in-out forwards;
    z-index: 2;
    transition: all 1s ease;
    opacity: 0;
  }
  @keyframes fadeIn {
    from { opacity: 0; transform: scale(0.8); }
    to { opacity: 1; transform: scale(1); }
  }

  .logo-sequence {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 40px;
    margin-bottom: 30px;
    transition: all 1s ease;
  }
  .logo3D {
    width: 180px;
    opacity: 0;
    transform: scale(0.3) rotateY(0deg);
    filter: drop-shadow(0 0 10px rgba(255,255,255,0.6));
    animation: showLogo 1.5s ease forwards;
  }
  @keyframes showLogo {
    0% { opacity: 0; transform: scale(0.3) rotateY(0deg); }
    50% { opacity: 1; transform: scale(1.1) rotateY(180deg); }
    100% { opacity: 1; transform: scale(1) rotateY(360deg); }
  }
  .logo1 { animation-delay: 0.5s; }
  .logo2 { animation-delay: 2.3s; }
  .logo3 { animation-delay: 4.1s; }

  @keyframes pyramidMoveLeft {
    0% { transform: translate(0,0) scale(1); }
    100% { transform: translate(-150px, 80px) scale(0.9); }
  }
  @keyframes pyramidMoveCenter {
    0% { transform: translate(0,0) scale(1); }
    100% { transform: translate(0,-90px) scale(1.1); }
  }
  @keyframes pyramidMoveRight {
    0% { transform: translate(0,0) scale(1); }
    100% { transform: translate(150px, 80px) scale(0.9); }
  }
  .pyramid .logo1 { animation: showLogo 1.5s ease forwards, pyramidMoveLeft 2s ease-in-out forwards 6.5s; }
  .pyramid .logo2 { animation: showLogo 1.5s ease forwards, pyramidMoveCenter 2s ease-in-out forwards 6.5s; }
  .pyramid .logo3 { animation: showLogo 1.5s ease forwards, pyramidMoveRight 2s ease-in-out forwards 6.5s; }

  body.idle-mode .logo3D {
    animation: rotateIdle 8s linear infinite;
    filter: drop-shadow(0 0 20px rgba(0,255,100,0.8));
  }
  @keyframes rotateIdle {
    from { transform: rotateY(0deg) scale(1.05); }
    to { transform: rotateY(360deg) scale(1.05); }
  }

  .idle-message {
    position: absolute;
    top: 25%;
    left: 50%;
    transform: translateX(-50%);
    font-size: 24px;
    color: #d4ffb5;
    text-shadow: 0 0 18px rgba(0,255,100,0.7);
    opacity: 0;
    z-index: 5;
    text-align: center;
    transition: opacity 1s ease, transform 1s ease;
    pointer-events: none;
  }
  body.idle-mode .idle-message {
    opacity: 1;
    transform: translateX(-50%) translateY(-5px);
  }

  .particle {
    position: absolute;
    background: radial-gradient(circle, rgba(255,255,150,0.9) 0%, rgba(0,255,100,0.25) 70%);
    border-radius: 50%;
    opacity: 0.9;
    animation: floatParticle linear infinite;
    mix-blend-mode: screen;
  }
  @keyframes floatParticle {
    from { transform: translateY(100vh) scale(0.2); opacity: 0.9; filter: blur(0px); }
    50% { filter: blur(1px); }
    to { transform: translateY(-10vh) scale(1.1); opacity: 0; filter: blur(2px); }
  }

  h1 { font-size: 32px; text-shadow: 0 3px 6px rgba(0,0,0,0.4); opacity: 0; animation: fadeUp 1s ease forwards 6s; }
  @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
  p, input, button, .footer { opacity: 0; animation: fadeUp 1s ease forwards 6.5s; }

  input { padding: 10px; font-size: 16px; border-radius: 8px; border: none; margin: 15px 0; text-align: center; }
  button {
    background: #ffeb3b; color: #333; font-size: 18px;
    padding: 12px 30px; border: none; border-radius: 10px;
    cursor: pointer; transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(0,0,0,0.4);
  }
  button:hover { background: #fbc02d; transform: scale(1.08); }
  .msg { margin-top: 10px; font-size: 15px; }

  .footer { margin-top: 25px; font-size: 14px; opacity: 0.8; animation-delay: 7s; }
  .footer img { width: 22px; height: 15px; margin-left: 6px; vertical-align: middle; animation: wave 2s infinite ease-in-out; }
  @keyframes wave { 0%,100%{transform:rotate(0deg);} 50%{transform:rotate(10deg);} }
</style>
</head>
<body>

  <!-- INTRO LOGO IESS -->
  <img src="iess2.png" alt="Logo IESS" class="intro-logo" id="introLogo">

  <img src="logo_UTSS.png" alt="Logo UTSS" class="background-logo">

  <div class="container" id="mainContainer">
    <div class="logo-sequence pyramid">
      <img src="A_3D-rendered_digital_logo_features_a_square-shape.png" class="logo3D logo1" alt="Logo 1">
      <img src="A_3D-rendered_digital_image_features_the_logo_of_t.png" class="logo3D logo2" alt="Logo 2">
      <img src="A_3D-rendered_digital_image_showcases_the_Adaptati.png" class="logo3D logo3" alt="Logo 3">
    </div>

    <h1>IESS - Kairouan</h1>
    <p>Veuillez entrer le mot de passe pour acc√©der √† la carte interactive.</p>
    <input type="password" id="password" placeholder="Mot de passe"><br>
    <button id="loginBtn">üîê Se connecter</button>
    <div id="message" class="msg"></div>

    <div class="footer">
      Powered by Ing. ABBASSI Brahim 
      <img src="https://upload.wikimedia.org/wikipedia/commons/c/ce/Flag_of_Tunisia.svg" alt="Drapeau Tunisien"><br>
      <span style="font-size:13px; opacity:0.8;">¬© 2025 ABBASSI ‚Äì Tous droits r√©serv√©s</span>
    </div>
  </div>

  <div class="idle-message" id="idleMessage">
    üåø ¬´ Investir dans les communaut√©s rurales, c‚Äôest nourrir l‚Äôavenir. ¬ª üåø
  </div>

  <audio id="ambientSound" loop>
    <source src="https://cdn.pixabay.com/download/audio/2022/03/22/audio_0b98a36e6f.mp3?filename=forest-ambient-111154.mp3" type="audio/mp3">
  </audio>

<script>
/* Attente avant affichage du contenu principal */
document.getElementById("mainContainer").style.display="none";
setTimeout(()=>{
  document.getElementById("introLogo").style.display="none";
  document.getElementById("mainContainer").style.display="block";
},5500);

/* Ton code complet ci-dessous inchang√© */
const PASSWORD="utss2025";const TOKEN_KEY="site_token";const SECRET="cle_privee_ultra_simple";
const MAX_ATTEMPTS=3;const LOCK_MINUTES=2;
function sha256Hex(str){const enc=new TextEncoder().encode(str);return crypto.subtle.digest("SHA-256",enc).then(b=>Array.from(new Uint8Array(b)).map(x=>x.toString(16).padStart(2,"0")).join(""));}

function nowMs(){return Date.now();}
function getState(){return JSON.parse(localStorage.getItem("auth_state")||"{}");}
function saveState(s){localStorage.setItem("auth_state",JSON.stringify(s));}
function setMessage(msg,err=false){const el=document.getElementById("message");el.textContent=msg;el.style.color=err?"#ff8080":"#cfff8f";}

document.getElementById("loginBtn").addEventListener("click",async()=>{
const pwd=document.getElementById("password").value.trim();const st=getState();const now=nowMs();
if(st.lockedUntil&&now<st.lockedUntil){const diff=Math.ceil((st.lockedUntil-now)/60000);setMessage(`Compte verrouill√©. R√©essayez dans ${diff} min.`,true);return;}
if(pwd===PASSWORD){localStorage.removeItem("auth_state");const exp=now+20*60*1000;const sig=await sha256Hex(SECRET+"|"+exp);
const token={user:"admin",exp:exp,sig:sig};localStorage.setItem(TOKEN_KEY,btoa(JSON.stringify(token)));window.location.href="CarteSousse.html";}
else{st.attempts=(st.attempts||0)+1;if(st.attempts>=MAX_ATTEMPTS){st.lockedUntil=now+LOCK_MINUTES*60*1000;setMessage(`Trop d'essais. Verrouillage ${LOCK_MINUTES} minutes.`,true);}
else{const rest=MAX_ATTEMPTS-st.attempts;setMessage(`Mot de passe incorrect. ${rest} tentative(s) restante(s).`,true);}saveState(st);}});

let inactivityTimer;let particlesActive=false;const sound=document.getElementById("ambientSound");
function resetTimer(){
clearTimeout(inactivityTimer);document.body.classList.remove("idle-mode");
if(particlesActive){document.querySelectorAll(".particle").forEach(p=>p.remove());particlesActive=false;sound.pause();}
inactivityTimer=setTimeout(triggerMagic,15000);
}
function triggerMagic(){
document.body.classList.add("idle-mode");
if(!particlesActive){createParticles(60);particlesActive=true;sound.volume=0.4;sound.play();
const particleInterval=setInterval(()=>{if(!document.body.classList.contains("idle-mode"))clearInterval(particleInterval);
else createParticles(2+Math.random()*3);},800);}
}
["mousemove","keydown","click"].forEach(evt=>{window.addEventListener(evt,()=>{resetTimer();if(sound.paused){sound.play().catch(()=>{});}});});
resetTimer();

function createParticles(n){
for(let i=0;i<n;i++){const p=document.createElement("div");p.classList.add("particle");
const size=Math.random()*8+4;p.style.width=`${size}px`;p.style.height=`${size}px`;p.style.left=`${Math.random()*100}vw`;
p.style.animationDuration=`${8+Math.random()*6}s`;p.style.animationDelay=`${Math.random()*4}s`;document.body.appendChild(p);}}
  
const messages=[
"üåø ¬´ Investir dans les communaut√©s rurales, c‚Äôest nourrir l‚Äôavenir. ¬ª üåø",
"üåæ ¬´ Chaque graine accompagn√©e est une promesse d‚Äôautonomie. ¬ª üåæ",
"üíß ¬´ L‚Äôinnovation durable commence avec l‚Äôhumain. ¬ª üíß",
"üå± ¬´ L‚Äôunion des efforts fait fleurir la terre. ¬ª üå±"];
let messageIndex=0;let messageInterval=null;
function startMessageCycle(){
const el=document.getElementById("idleMessage");if(!el)return;
el.innerHTML=messages[0];messageIndex=0;
messageInterval=setInterval(()=>{
messageIndex=(messageIndex+1)%messages.length;
el.style.opacity=0;setTimeout(()=>{el.innerHTML=messages[messageIndex];el.style.opacity=1;},1000);
},9000);
}
function stopMessageCycle(){clearInterval(messageInterval);messageInterval=null;}
const _triggerMagic=triggerMagic;const _resetTimer=resetTimer;
triggerMagic=function(){_triggerMagic();startMessageCycle();};
resetTimer=function(){_resetTimer();stopMessageCycle();};
</script>
</body>
</html>
